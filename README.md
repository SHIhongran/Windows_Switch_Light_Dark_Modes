- # Windows 主题智能切换器 v1.6.1

  一个简洁优雅的 Windows 桌面应用程序，用于快速切换系统的浅色和暗色主题。

  ## v1.6.1 更新日志

- **重大 Bug 修复**：彻底解决了窗口在某些情况下（特别是通过边缘触发显示后）不会自动隐藏的问题。重构了底层的显示/隐藏逻辑，用统一的、可靠的鼠标位置轮询机制取代了之前不稳定的UI事件绑定，确保窗口在任何场景下都能按预期自动收缩。

## 功能特性

  ### 🎨 核心功能

  - **一键切换**：快速在 Windows 浅色和暗色主题间切换。

  - **状态显示**：实时显示当前系统主题模式。

  - **资源管理器重启**：可选择同时重启资源管理器以完全应用主题更改。

  ### 🖥️ 界面特性

  - **极简设计**：无边框现代化界面。

  - **边缘吸附**：拖拽到屏幕边缘自动吸附。

  - **自动隐藏**：窗口弹出后自动隐藏，只在边缘留下触发区域，节省屏幕空间，方便设置为开机启动。

  - **智能显示**：鼠标靠近边缘时自动显示窗口。

  ## 系统要求

  - **操作系统**：Windows 10/11

  - **Python 版本**：3.6+ (如果运行源码)

  - **权限要求**：普通用户权限即可

  ## 安装使用

  ### 方法一：直接运行 Python 脚本

  1. 确保已安装 Python 3.6+。

  1. 下载项目文件到本地。

  1. 运行主程序：

  ```
  python theme_switcher.py
  ```

  ### 方法二：打包为 EXE 文件

  1. 安装 PyInstaller：

  ```
  pip install pyinstaller
  ```

  1. 在项目目录下双击 “build.bat” 执行打包命令。

  1. 打包完成后，在dist目录下找到生成的 EXE 文件。

  ## 使用说明

  ### 基本操作

  1. **启动程序**：运行后窗口会在屏幕中央显示，随后自动隐藏。

  1. **切换主题**：点击 "切换主题" 按钮即可在浅色 / 暗色主题间切换。

  1. **重启选项**：勾选 "同时重启资源管理器" 可确保主题完全生效。

  ### 高级功能

  1. **边缘吸附**：拖拽窗口到屏幕左、右或上边缘释放，窗口会自动吸附。

  1. **自动隐藏**：吸附后窗口会自动隐藏，只在边缘留下触发区域。

  1. **快速显示**：将鼠标移动到隐藏窗口的边缘区域，窗口会自动滑出。

  1. **自动收回**：鼠标离开窗口区域 2 秒后，窗口会自动收回隐藏。

  ## 文件结构

  ```
  系统浅暗色切换/
  ├── theme_switcher.py          # 主程序文件
  ├── toggle_theme.bat           # 基础主题切换脚本
  ├── toggle_and_restart.bat     # 主题切换+重启资源管理器脚本
  ├── restart_explorer_only.bat  # 仅重启资源管理器脚本
  ├── requirements.txt           # 项目依赖说明
  ├── build.bat                  # 打包脚本
  ├── icon.ico                   # 程序图标
  └── README.md                  # 项目说明文档
  ```

  ## 技术实现

  ### 架构设计

  - **前端**：Python Tkinter (轻量级 GUI 框架)

  - **主题切换**：通过调用批处理脚本修改 Windows 注册表

  - **状态检测**：直接读取注册表获取当前主题状态

  - **边缘检测**：使用 Windows API 进行鼠标位置追踪

  ### 核心模块

  - subprocess：执行外部批处理脚本

  - winreg：读取 Windows 注册表

  - ctypes：调用 Windows 原生 API

  - threading：多线程鼠标位置监控

  ## 更新日志

  ### v1.3

  - 优化窗口显示逻辑，页面弹出后自动隐藏，方便用户设置为开机启动。

  ### v1.2

  - 实现边缘吸附和自动隐藏功能。

  - 优化用户界面设计。

  - 添加鼠标位置追踪。

  - 改进错误处理机制。

  ### v1.1

  - 添加资源管理器重启选项。

  - 优化主题状态检测。

  - 改进脚本执行机制。

  ### v1.0

  - 基础主题切换功能。

  - 简洁的图形界面。

  - 注册表状态读取。

  ## 注意事项

  1. **兼容性**：仅支持 Windows 10/11 系统。

  1. **权限**：程序需要修改注册表，但使用的是用户级注册表项，无需管理员权限。

  1. **资源管理器重启**：选择重启资源管理器时，桌面会短暂消失后恢复，这是正常现象。

  1. **主题生效**：某些应用可能需要重启才能完全应用新主题。

  ## 故障排除

  ### 常见问题

  **Q: 主题切换后部分应用没有变化？**

  A: 勾选 "同时重启资源管理器" 选项，或手动重启相关应用。

  **Q: 程序无法启动？**

  A: 确保 Python 环境正确安装，或检查 EXE 文件是否完整。

  **Q: 边缘吸附不工作？**

  A: 确保将窗口完全拖拽到屏幕边缘并释放鼠标。

  **Q: 自动隐藏后无法显示？**

  A: 将鼠标移动到屏幕对应边缘的最边缘位置。