# Windows 系统主题切换器

![License](https://img.shields.io/badge/license-MIT-blue.svg)
![Python](https://img.shields.io/badge/python-3.6+-green.svg)
![Platform](https://img.shields.io/badge/platform-Windows%2010%2F11-lightgrey.svg)

一个用于快速切换 Windows 系统浅色和暗色主题的桌面应用。

## ✨ 主要功能

- **一键切换**: 快速在浅色和暗色主题间切换，并实时显示当前状态。
- **智能界面**: 现代化的无边框设计，支持边缘吸附和自动显隐，节省屏幕空间。
- **定时任务**: 可自定义时间，让系统在指定时间自动切换主题。
- **专业体验**: 包含优雅的启动画面和流畅的操作锁定机制。
- **配置保存**: 所有设置（如定时任务、重启选项）都会被自动保存。

## 🚀 安装与使用

1.  **下载**: 从发布页面下载最新的 `exe` 可执行文件。
2.  **运行**: 直接双击 `theme_switcher.exe` 即可启动。
3.  **操作**: 
    -   鼠标移动到屏幕右侧边缘可唤出主窗口。
    -   点击按钮或设置定时任务来切换主题。
    -   勾选“切换后重启资源管理器”可确保主题完全应用。

## 📜 更新日志

### v1.6.3 (高效渐进式调度器)
- **核心算法重构**: 采用全新的“渐进式逼近”调度算法，重构了定时切换功能，显著提升了后台任务的执行效率。
- **代码优化**: 移除了旧的低效调度器及相关代码。

### v1.6.2 (Bug修复与UI优化)
- **Bug修复**: 解决了因事件冲突导致无法修改定时切换时间的严重Bug。
- **UI优化**: 重构了定时切换模块的布局和图标，提升了清晰度和易用性。

### v1.6.1 (功能增强)
- **智能切换**: 自动切换功能现在会遵循“切换后重启资源管理器”的设置。
- **配置持久化**: “重启资源管理器”选项的状态会被保存并在下次启动时加载。

### v1.6.0 (定时切换)
- **新功能**: 新增定时自动切换功能，可自定义暗/浅色模式的切换时间。
- **后台调度**: 采用后台调度器，每分钟检查一次是否需要执行切换。

### v1.5.1 (稳定性修复)
- **启动优化**: 解决了首次启动时屏幕边缘出现两个隐藏界面的问题。
- **代码重构**: 改进了窗口初始化逻辑，提升了程序稳定性。

### v1.5 (重大更新)
- **启动画面**: 新增了专业的启动画面，可自动适配当前系统主题。
- **UI锁定**: 在执行耗时操作时自动锁定界面，防止用户误操作，并提供视觉反馈。

### v1.4.1 (Bug修复)
- **Bug修复**: 彻底解决了窗口在某些情况下不会自动隐藏的问题，重构了显示/隐藏逻辑。

### v1.3

- 优化窗口显示逻辑，页面弹出后自动隐藏，方便用户设置为开机启动。

### v1.2

- 实现边缘吸附和自动隐藏功能。
- 优化用户界面设计。
- 添加鼠标位置追踪。
- 改进错误处理机制。

### v1.1

- 添加资源管理器重启选项。
- 优化主题状态检测。
- 改进脚本执行机制。

### v1.0

- 基础主题切换功能。
- 简洁的图形界面。
- 注册表状态读取。

## 🛠️ 技术实现

- **前端**: Python Tkinter
- **核心**: 通过修改 Windows 注册表实现主题切换，并使用 `ctypes` 调用原生 API 进行鼠标位置追踪。
- **打包**: 使用 PyInstaller 打包为独立的 `.exe` 文件。

## 📄 文件结构

```
系统浅暗色切换/
├── theme_switcher.py          # 主程序
├── toggle_theme.bat           # 主题切换脚本
├── toggle_and_restart.bat     # 切换并重启资源管理器脚本
├── restart_explorer_only.bat  # 仅重启资源管理器脚本
├── requirements.txt           # 依赖
├── build.bat                  # 打包脚本
├── config.ini                 # 配置文件
└── icon.ico                   # 图标

## 注意事项

1. **兼容性**：仅支持 Windows 10/11 系统。

2. **权限**：程序需要修改注册表，但使用的是用户级注册表项，无需管理员权限。

3. **启动体验** (v1.5+)：首次启动会显示2秒启动画面，这是正常的初始化过程。

4. **启动优化** (v1.5.1)：已修复启动时可能出现的窗口重复显示问题。

5. **操作锁定** (v1.5+)：执行主题切换时界面会临时锁定，请等待操作完成。

6. **资源管理器重启**：选择重启资源管理器时，桌面会短暂消失后恢复，这是正常现象。

7. **主题生效**：某些应用可能需要重启才能完全应用新主题。

## 故障排除

### 常见问题

**Q: 启动时看到两个窗口闪烁？** (v1.5.1已修复)

A: 此问题已在v1.5.1中修复。如仍遇到，请更新到最新版本。

**Q: 启动画面显示时间过长？** (v1.5)

A: 启动画面固定显示2秒，这是正常的初始化时间，请耐心等待。

**Q: 操作时界面被锁定无法点击？** (v1.5)

A: 这是防误操作的保护机制，请等待"处理中..."提示消失后再操作。

**Q: 主题切换后部分应用没有变化？**

A: 勾选 "切换后重启资源管理器" 选项，或手动重启相关应用。

**Q: 程序无法启动？**

A: 确保 Python 环境正确安装，或检查 EXE 文件是否完整。

**Q: 边缘吸附不工作？**

A: 确保将窗口完全拖拽到屏幕边缘并释放鼠标。

**Q: 自动隐藏后无法显示？**

A: 将鼠标移动到屏幕对应边缘的最边缘位置。

**Q: 启动画面颜色显示异常？** (v1.5)

A: 启动画面会自动适配系统主题，如显示异常请检查系统主题设置。

### 开发环境设置

```bash
# 克隆仓库
git clone https://github.com/yourusername/theme-switcher.git
cd theme-switcher

# 安装依赖
pip install -r requirements.txt

# 运行程序
python theme_switcher.py
```

### 代码规范

- 使用 4 个空格缩进
- 遵循 PEP 8 编码规范
- 添加适当的注释和文档字符串
- 确保新功能有相应的测试

## 📄 许可证

本项目采用 MIT 许可证 - 查看 [LICENSE](LICENSE) 文件了解详情。

## 🙏 致谢

- 感谢所有贡献者的支持
- 感谢 Python Tkinter 社区
- 感谢 Windows API 文档

📞 联系方式
如果您有任何问题或建议，请通过以下方式联系：

🐛 Issues: GitHub Issues  
💬 Discussions: GitHub Discussions

⭐ 如果这个项目对您有帮助，请给它一个星标！